
setwd("/Users/milanmalinsky/Sanger_work/trio_assembly_data/140827_yeast_data/JB759_JB853_JB859_JB915/")
source("/Users/milanmalinsky/Sanger_work/sga_git_direct/sga/src/bin/plot_contig_lenghts_functions.R")
p4a65 <- read.table("paternal_child4_0.33.contigs65.fa-contigs_sizes.txt",)
a70 <- read.table("paternal_child4_0.33.contigs70.fa-contigs_sizes.txt")
a75 <- read.table("paternal_child4_0.33.contigs75.fa-contigs_sizes.txt")
a80 <- read.table("paternal_child4_0.33.contigs80.fa-contigs_sizes.txt")
plot.overlap.l(); quartz()
m4a65 <- read.table("maternal_child4_0.33.contigs65.fa-contigs_sizes.txt",)
a70 <- read.table("maternal_child4_0.33.contigs70.fa-contigs_sizes.txt")
a75 <- read.table("maternal_child4_0.33.contigs75.fa-contigs_sizes.txt")
a80 <- read.table("maternal_child4_0.33.contigs80.fa-contigs_sizes.txt")
plot.overlap.l(); quartz()
c4a65 <- read.table("child4_0.33.contigs65.fa-contigs_sizes.txt",)
a70 <- read.table("child4_0.33.contigs70.fa-contigs_sizes.txt")
a75 <- read.table("child4_0.33.contigs75.fa-contigs_sizes.txt")
a80 <- read.table("child4_0.33.contigs80.fa-contigs_sizes.txt")
plot.overlap.l(); quartz()
a65 <- read.table("paternal_child3_0.33.contigs65.fa-contigs_sizes.txt",)
a70 <- read.table("paternal_child3_0.33.contigs70.fa-contigs_sizes.txt")
a75 <- read.table("paternal_child3_0.33.contigs75.fa-contigs_sizes.txt")
a80 <- read.table("paternal_child3_0.33.contigs80.fa-contigs_sizes.txt")
plot.overlap.l(); quartz()
a65 <- read.table("maternal_child3_0.33.contigs65.fa-contigs_sizes.txt",)
a70 <- read.table("maternal_child3_0.33.contigs70.fa-contigs_sizes.txt")
a75 <- read.table("maternal_child3_0.33.contigs75.fa-contigs_sizes.txt")
a80 <- read.table("maternal_child3_0.33.contigs80.fa-contigs_sizes.txt")
plot.overlap.l(); quartz()
a65 <- read.table("child3_0.33.contigs65.fa-contigs_sizes.txt",)
a70 <- read.table("child3_0.33.contigs70.fa-contigs_sizes.txt")
a75 <- read.table("child3_0.33.contigs75.fa-contigs_sizes.txt")
a80 <- read.table("child3_0.33.contigs80.fa-contigs_sizes.txt")
plot.overlap.l();


p4a65 <- read.table("paternal_child4.contigs65.fa-contigs_sizes.txt",)
p4a70 <- read.table("paternal_child4.contigs70.fa-contigs_sizes.txt")
p4a75 <- read.table("paternal_child4.contigs75.fa-contigs_sizes.txt")
p4a80 <- read.table("paternal_child4.contigs80.fa-contigs_sizes.txt")
plot.overlap.l(p4a65,p4a70,p4a75,p4a80); quartz()
m4a65 <- read.table("maternal_child4.contigs65.fa-contigs_sizes.txt",)
m4a70 <- read.table("maternal_child4.contigs70.fa-contigs_sizes.txt")
m4a75 <- read.table("maternal_child4.contigs75.fa-contigs_sizes.txt")
m4a80 <- read.table("maternal_child4.contigs80.fa-contigs_sizes.txt")
plot.overlap.l(m4a65,m4a70,m4a75,m4a80); quartz()
c4a65 <- read.table("child4.contigs65.fa-contigs_sizes.txt",)
c4a70 <- read.table("child4.contigs70.fa-contigs_sizes.txt")
c4a75 <- read.table("child4.contigs75.fa-contigs_sizes.txt")
c4a80 <- read.table("child4.contigs80.fa-contigs_sizes.txt")
plot.overlap.l(c4a65,c4a70,c4a75,c4a80); quartz()
p3a65 <- read.table("paternal_child3.contigs65.fa-contigs_sizes.txt",)
p3a70 <- read.table("paternal_child3.contigs70.fa-contigs_sizes.txt")
p3a75 <- read.table("paternal_child3.contigs75.fa-contigs_sizes.txt")
p3a80 <- read.table("paternal_child3.contigs80.fa-contigs_sizes.txt")
plot.overlap.l(p3a65,p3a70,p3a75,p3a80); quartz()
m3a65 <- read.table("maternal_child3.contigs65.fa-contigs_sizes.txt",)
m3a70 <- read.table("maternal_child3.contigs70.fa-contigs_sizes.txt")
m3a75 <- read.table("maternal_child3.contigs75.fa-contigs_sizes.txt")
m3a80 <- read.table("maternal_child3.contigs80.fa-contigs_sizes.txt")
plot.overlap.l(m3a65,m3a70,m3a75,m3a80); quartz()
c3a65 <- read.table("child3.contigs65.fa-contigs_sizes.txt",)
c3a70 <- read.table("child3.contigs70.fa-contigs_sizes.txt")
c3a75 <- read.table("child3.contigs75.fa-contigs_sizes.txt")
c3a80 <- read.table("child3.contigs80.fa-contigs_sizes.txt")
plot.overlap.l(c3a65,c3a70,c3a75,c3a80);
quartz()
pdf("/Users/milanmalinsky/Sanger_work/trio_assembly_data/140827_yeast_data/JB759_JB853_JB859_JB915/contig_lengths.pdf", width=10, height=7)
plot.overlap.l.connected(c3a75,m3a75,c3a75,m3a75)
legend("topright", legend=c("normal assembly", "trio assembly"),col=c("blue","orange"), lty=1)
dev.off()

plot.length.oneLine()

plot.dpm.connected(c4a75,p4a70,m4a70) 

plot.dpm.connected(c3a75,p3a65,m3a75) 

upc4a65 <- read.table("paternal_child4_0.33.triomerged65_useparent-contigs_sizes.txt")
plot.overlap.l.connected(c4a65,upc4a65,p4a65,m4a65)
plot.dpm.connected(upc4a65,p4a65,m4a65) 

plot.length.oneLine <- function() {
	a65[,3] <- log(a65[,3],base=10); a70[,3] <- log(a70[,3],base=2); a75[,3] <- log(a75[,3],base=2); a80[,3] <- log(a80[,3],base=2)
	maxL <- max(a65[,2],a70[,2],a75[,2],a80[,2])
	maxC <- max(a65[,3],a70[,3],a75[,3],a80[,3])

	plot(1,1,col="white",xlim=c(0,maxL),ylim=c(0,maxC),xlab="Contig length",ylab="Count")
	lines(a65[,1],a65[,3],col="red")
	lines(a70[,1],a70[,3],col="green")
	lines(a75[,1],a75[,3],col="blue")
	lines(a80[,1],a80[,3],col="orange")
}

# A.calliptera assembly
setwd("/Users/milanmalinsky/Sanger_work/trio_assembly_data/cichlid_scaffold_stats")
jared <- read.table("maternal.lib.paired_end_and_mate_n3_5_min200_scaffolds_gapfilled_m500_b1000_sizes.txt")
matesToPairedEnds <- read.table("maternal.lib.mate_n3_min200_to_pairedEndScaffolds_gapfilled_m500_b1000_sizes.txt")
pdf("cichlid_scaffold_l.pdf",width=12,height=7)
options(scipen=99)
plot.overlap.l.connected(jared,jared,matesToPairedEnds,matesToPairedEnds);
legend("topright",legend=c("'Normal' scaffolding", "Mates to paired-end scaffolds"), lty=1, col=c("green", "orange"))
dev.off() 

setwd("/Users/milanmalinsky/Sanger_work/trio_assembly_data/cichlid_scaffold_stats")
normal_scaffolds <- read.table("all_92.lib.mate_n3_min200_to_pairedEndScaffolds_gapfilled_m500_b1000_sizes.txt")
trio_scaffolds <- read.table("A_stuartgranti_maternal.lib.mate_n3_min200_to_pairedEndScaffolds_gapfilled_m500_b1000_sizes.txt")
pdf("A_stuartgranti_scaffold_l_compare.pdf",width=7,height=3.8)
options(scipen=99)
plot.overlap.l.connected(normal_scaffolds,normal_scaffolds,trio_scaffolds,trio_scaffolds);
legend("topright",legend=c("'Normal' assembly", "Trio assembly"), lty=1, lwd=2, col=c("green", "orange"))
dev.off() 



setwd("/Users/milanmalinsky/Sanger_work/trio_assembly_data/cichlid_scaffold_stats")
normal_scaffolds <- read.table("Andinoacara_coeruleopunctatus.k41.assembled.90-contigs_min_200_n5_min200_scaffolds_gapfilled_m500_b1000_sizes.txt")
pdf("Andinoacara_coeruleopunctatus_scaffolds_min500.pdf",width=7,height=3.8)
options(scipen=99)
plot.overlap.l.connected(normal_scaffolds,normal_scaffolds,normal_scaffolds,normal_scaffolds,TRUE);
#legend("topright",legend=c("'Normal' assembly", "Trio assembly"), lty=1, lwd=2, col=c("green", "orange"))
dev.off() 
